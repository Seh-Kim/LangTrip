<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8">
  <title>강의 추천 게시판</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.5/dist/css/bootstrap.min.css"/>
  <link rel="stylesheet" th:href="@{/css/common.css}">		
  <style>
  .tab-button {
    padding: 6px 16px;
    border: 1px solid #ccc;
    background-color: white;
    color: #000;
    font-weight: bold;
    cursor: pointer;
    transition: background-color 0.2s, color 0.2s;
  }

  

  .tab-button.active {
    background-color: #263c96;
    color: white;
    border-color: #263c96;
  }

  .custom-write-btn {
    border: 1px solid #263c96;
    color: #263c96;
    background-color: white;
    font-weight: bold;
    font-size: 14px;
  }

  .custom-write-btn:hover {
    background-color: #263c96;
    color: white;
  }

  .board-title {
    color: #263c96;
    border-bottom: 2px solid #444;
    padding-bottom: 10px;
    margin-bottom: 20px;
  }

  .header-controls {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 15px;
  }

  .tab-group {
    display: flex;
    gap: 8px;
  }

  .right-controls {
    display: flex;
    align-items: center;
    gap: 10px;
  }

  .dropdown .btn {
    padding: 4px 10px;
    font-size: 14px;
    border-color: #ccc;
    color: #000;
  }

  .dropdown-menu {
    min-width: 70px;
  }
  
  .title-column{
  white-space: nowrap;        
  overflow: hidden;           
  text-overflow: ellipsis;   
  max-width: 30px;  	
  }
</style></head>



<body class="container mt-5">

  
<div th:replace="layout/header :: header"></div>


  <h3 class="board-title"><strong>강의 추천 게시판</strong></h3>

  <div class="header-controls">
    <!-- 왼쪽 탭 버튼 -->
    <div class="tab-group">
  <button class="tab-button" data-tab="all" th:classappend="${tab == 'all'} ? 'active'">전체글</button>
  <button class="tab-button" data-tab="best" th:classappend="${tab == 'best'} ? 'active'">개념글</button>
  <button class="tab-button" data-tab="notice" th:classappend="${tab == 'notice'} ? 'active'">공지</button>
</div>


	<form id="filterForm" method="get" th:action="@{/csj/community}">
  <input type="hidden" name="page" th:value="${currentPage}" />
  <input type="hidden" name="size" th:value="${size}" id="pageSizeInput" />
  <input type="hidden" name="tab" th:value="${tab}" id="tabInput" />
   		<strong>제목+내용</strong><input type="text" /> 
   		<input type="button" value="검색" class="btn btn-success"/>
</form>


    <!-- 오른쪽 드롭다운 + 글쓰기 -->
    <div class="right-controls">
      <div class="dropdown">
        <button class="btn btn-outline-secondary btn-sm dropdown-toggle" 
        type="button" 
        data-bs-toggle="dropdown"
        aria-expanded="false"
        id="dropdownMenuButton"
        th:text="${size} + '개'">
  50개
</button>

        <ul class="dropdown-menu">
          <li><a class="dropdown-item" href="#">30개</a></li>
          <li><a class="dropdown-item" href="#">50개</a></li>
          <li><a class="dropdown-item" href="#">100개</a></li>
        </ul>
      </div>

      <a href="/csj/communityWrite" class="btn btn-sm custom-write-btn">
        <i class="bi bi-pencil-fill me-1"></i> 글쓰기
      </a>
    </div>
  </div>

 <table class="table table-hover table-sm text-center align-middle">
  <thead class="table-light">
    <tr>
      <th style="width: 60px;">번호</th>
      <th class="text-center">제목</th>
      <th style="width: 100px;">작성자</th>
      <th style="width: 150px;">작성일</th>
      <th style="width: 60px;">조회</th>
      <th style="width: 60px;">추천</th>
    </tr>
  </thead>
  <tbody>
    <tr th:each="post, iterStat : ${postList}"
    th:onclick="|location.href='/csj/community/detail?postId=${post.postId}'|"
    style="cursor: pointer;">
    
 <td th:if="${tab == 'best'}"
    th:text="${bestPostCount - ((currentPage - 1) * size) - iterStat.index}">1</td>


  <td th:if="${tab != 'best'}"
      th:text="${#numbers.formatDecimal(totalPostCount - ((currentPage - 1) * size) - iterStat.index, 0, 0)}">1</td>

  <td class="text-center title-column" th:text="${post.title}">제목</td>
  <td th:text="${post.nickname}">작성자</td>
  <td th:text="${post.createdAt != null ? #dates.format(post.createdAt, 'yyyy-MM-dd HH:mm') : ''}">작성일</td>
  <td th:text="${post.views}">0</td>
  <td th:text="${post.upCount}">0</td>
</tr>

  </tbody>
</table>


  <nav>
  <ul class="pagination justify-content-center">
    <li class="page-item" th:classappend="${currentPage == 1} ? 'disabled'">
      <a class="page-link"
         th:href="@{/csj/community(page=${currentPage - 1}, size=${size})}">◀</a>
    </li>

    <li th:each="i : ${#numbers.sequence(1, totalPages)}"
        class="page-item"
        th:classappend="${i == currentPage} ? 'active'">
      <a class="page-link" th:href="@{/csj/community(page=${i}, size=${size})}"
         th:text="${i}">1</a>
    </li>

    <li class="page-item" th:classappend="${currentPage == totalPages} ? 'disabled'">
      <a class="page-link"
         th:href="@{/csj/community(page=${currentPage + 1}, size=${size})}">▶</a>
    </li>
    
  </ul>
</nav>
   

 <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.5/dist/js/bootstrap.bundle.min.js"></script>
<script>
  // 탭 버튼 active 처리
  document.querySelectorAll(".tab-button").forEach(function (btn) {
    btn.addEventListener("click", function () {
      document.querySelectorAll(".tab-button").forEach(function (b) {
        b.classList.remove("active");
      });
      this.classList.add("active");
    });
  });

  // 드롭다운 클릭 이벤트 (텍스트 변경 + form 전송)
  document.querySelectorAll(".dropdown-menu .dropdown-item").forEach(function (item) {
    item.addEventListener("click", function (e) {
      e.preventDefault();
      document.getElementById("dropdownMenuButton").innerText = this.innerText;

      // 선택한 size 값을 form에 반영하고 submit
      document.getElementById("pageSizeInput").value = this.innerText.replace("개", "");
      document.getElementById("filterForm").submit();
    });
  });
  
  document.querySelectorAll(".tab-button").forEach(function (btn) {
	  btn.addEventListener("click", function () {
	    const selectedTab = this.getAttribute("data-tab");
	    document.getElementById("tabInput").value = selectedTab;
	    document.getElementById("filterForm").submit();
	  });
	});

  
  
  
  
</script>



   <div th:replace="layout/footer :: footer"></div>
</body>
</html>
