<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="kr.co.sist.e_learning.mypage.LectureHistoryMapper">

  <select id="selectLectureHistory"
          parameterType="long"
          resultType="kr.co.sist.e_learning.mypage.LectureHistoryDTO">
    SELECT
      v.title AS videoTitle,
      c.title AS courseTitle,
      TO_CHAR(v.upload_date, 'YYYY-MM-DD') AS uploadDate,
      cs.is_completed AS completedYn
    FROM course_stat cs
    JOIN video v ON cs.video_seq = v.video_seq
    JOIN course c ON cs.course_seq = c.course_seq
    WHERE cs.user_seq = #{userSeq}
      AND cs.is_completed = 'Y'
    ORDER BY v.video_order ASC
  </select>

</mapper>
