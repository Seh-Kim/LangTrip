<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="kr.co.sist.e_learning.video.VideoMapper">

	<insert id="insertVideo" parameterType="kr.co.sist.e_learning.video.VideoDTO">
		INSERT INTO video (
		video_seq,
		course_seq,
		title,
		file_name,
		file_path,
		upload_date,
		description,
		is_completed,
		video_order
		) VALUES (
		video_seq.NEXTVAL,
		#{courseSeq},
		#{title},
		#{fileName},
		#{filePath},
		SYSDATE,
		#{description},
		#{isCompleted},
		#{videoOrder}
		)
	</insert>
	<select id="selectVideo" resultType="kr.co.sist.e_learning.video.VideoDTO">
		select * from video order by
		video_seq asc
	</select>

	<select id="getVideoBySeq" resultType="kr.co.sist.e_learning.video.VideoDTO"
		parameterType="int">
		SELECT *
		FROM video
		WHERE video_seq = #{videoSeq}
	</select>

	<update id="modifyVideo"
		parameterType="kr.co.sist.e_learning.video.VideoDTO">
		UPDATE video
		SET
		title = #{title},
		description = #{description},
		upload_date = SYSDATE
		<if test="fileName != null and fileName != ''">
			, file_name = #{fileName}
			, file_path = #{filePath}
		</if>
		WHERE video_seq = #{videoSeq}
	</update>
	<delete id="deleteVideo" parameterType="int">
	delete from video where video_seq=#{videoSeq}
	
	</delete>

	<select id="showVideo" parameterType="String"
		resultType="kr.co.sist.e_learning.video.VideoDTO">
		select * from video where video_seq=#{videoSeq}
	</select>

	<select id="showVideoByCourseSeq" parameterType="String"
		resultType="kr.co.sist.e_learning.video.VideoDTO">
		select * from video where course_seq=#{courseSeq}

	</select>
	<select id="getMaxVideoOrder" parameterType="String"
		resultType="Integer">
		select max(video_order) from video where course_seq =
		#{coursSeq}
	</select>
</mapper>
